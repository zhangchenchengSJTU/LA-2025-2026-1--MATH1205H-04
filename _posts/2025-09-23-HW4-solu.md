---
title: HW4-solu
author: Chencheng Zhang
layout: post
category: solution
---

## 转置

{% def %}
(矩阵转置). 给定一个 $m \times n$ 矩阵 ($m$ 横行, $n$ 纵列) 的矩阵 $A = (a_{i,j})_{1 \leq i \leq m, \ 1 \leq j \leq n}$, 定义转置矩阵 $A^T$ 为 $n \times m$ 规格的矩阵
$$
A^T = (a'_{i,j})_{1 \leq i \leq n, \ 1 \leq j \leq m},\quad a'_{i,j}= a_{j,i}.
$$
{% enddef %}

{% ex %}
例如,

$$
\begin{pmatrix}
1 & 2 & 3 \\
4 & 5 & 6
\end{pmatrix}^T = \begin{pmatrix}
1 & 4 \\
2 & 5 \\
3 & 6
\end{pmatrix}.
$$

{% endex %}

## 行秩 $=$ 列秩

{% pro %}
给定矩阵 $A$. 证明最简行阶梯形的非零行数等于最简列阶梯形的非零列数等于. 用 9-19-Ex-1 的话说, $ref(A)$ 与 $ref(A^T)$ 有相同的非零行数.
\\
\\
注: 对矩阵 $X$ 而言, 行变换与列变换的顺序可以交换. 因为行变换的本质是左乘某个矩阵 $A$, 列变换的本质是右乘某个矩阵 $B$. 由 $(AX)B = A(XB)$, 得证.

{% sol %}
可逆的列变换不改变非零行数. 记 $A'$ 是 $A$ 的最简列阶梯形, 则 $ref(A)$ 与 $ref(A')$ 有相同的非零行数. 注意到 $ref(A') = \begin{pmatrix}I_r & O \\ O & O\end{pmatrix}$, $r$ 是列阶梯形中的主元 $1$ 的数量, 从而也是 $A'$ 的非零列数.
{% endsol %}

{% endpro %}


## 巧算秩不等式

{% pro %}
记 $r(A)$ 为矩阵 $A$ 的秩, 也就是 $ref(A)$ 的非零行数. 请证明以下式子 (最好使用线性方程组的语言).

1. $r(A) = r(A^T)$ (即, **Ex-1** 结论);
2. $r(A) \leq r(A \quad B) \leq r(A) + r(B)$ (假定 $A$ 和 $B$ 行数相同);
3. $r(A) \leq r\binom AB \leq r(A) + r(B)$ (假定 $A$ 和 $B$ 列数相同);
4. $r(AB) \leq \min\{r(A), r(B)\}$ (假定 $A$ 列数等于 $B$ 行数);
5. $r(A) + r(B) = r\begin{pmatrix}A&O\\ O&B\end{pmatrix}$.

{% sol %}

1. 依照 **Ex-1** 即可. 注: $A$ 的$\textcolor{red}{列}$标准阶梯形是 $ref(A^T)^T$. 通常 $ref(A)^T \neq ref (A^T)$, 因为矩阵的行标准阶梯形和列标准阶梯形不一定相同. 通常也不会有 $ref(A^T) \neq ref(A)$, 因为 $A$ 与 $A^T$ 的行数与列数都未必相同.
2. (同时证明 (2) 与 (3) 的左侧 $\leq$). 依照[行阶梯形的算法](HW2-solu#行阶梯形存在且唯一), $ref(A\quad B) = (ref(A)\quad B')$, 从而得证. 也可以直接证明 $ref(A)$ 的非零行数不超过 $ref(A \quad B)$ 非零行数: 如果某个可逆行变换将 $(A\quad B)$ 变出 $k$ 个零行, 那么该变换也能让 $A$ 变出至少 $k$ 个零行. 实际上, 这也证明了 (3) 的左侧 $\leq$, 因为
   $$
   r(A) = r(A^T) \leq r(A^T \quad B^T) = r(\binom AB^T) = r(\binom AB).
   $$
3. (同时证明 (2) 与 (3) 的右侧 $\leq$). 可逆行变换不改变最简行阶梯形, 从而 $ref(\binom AB) = ref(\binom{ref(A)}{ref(B)})$. 注意到 $\binom{ref(A)}{ref(B)}$ 的非零行数是 $ref(A)$ 与 $ref(B)$ 非零行数之和. 对矩阵 $X$, $ref(X)$ 的非零行数不超过 $X$ 的行数, 从而得证. 实际上, 这也证明了 (2) 的右侧 $\leq$, 因为
   $$
   r(A \quad B) = r((A \quad B)^T) = r(\binom{A^T}{B^T}) \leq r(A^T) + r(B^T) = r(A) + r(B).
   $$
4. 假定读者熟悉行空间和列空间, 则 $AB$ 的行空间是 $B$ 行空间的子空间, 得证. 也可以从方程组的角度解释: 若 $Bx = 0$ 蕴含 $ABx = 0$, 从而 $ref(AB)$ 主元的数量不超过 $ref(B)$ 主元的数量, 故 $r(AB) \leq r(B)$. 通过转置, 可以证明 $r(AB) \leq r(A)$:
   $$
   r(AB) = r((AB)^T) = r(B^T A^T) \leq r(A^T) = r(A).
   $$
5. $ref \begin{pmatrix}A&O\\ O&B\end{pmatrix} = ref\begin{pmatrix}ref(A)&O\\ O&ref(B)\end{pmatrix}$, 右侧非零行数等于 $ref(A)$ 与 $ref(B)$ 非零行数之和.

{% endsol %}

{% endpro %}

## 配完全平方

{% pro %}
假定 $A$ 是取值为实数的矩阵. 证明 $Ax = 0$ 与 $A^T Ax = 0$ 有相同的解.

**作为惯例, 我们不使用粗体表示矩阵与向量. 请各位习惯这一点. 同样地, 考试时无需把 $v$ 写作 $\overrightarrow v$ 或 $\mathbf v$.**

{% pf %}
对列向量 $v$, $v= 0$ 当且仅当 $v^Tv = 0$. 这说明

$$
(A^T Ax = 0) \implies (x^T (A^T A x) = 0) \implies ((Ax)^T(Ax) = 0) \implies (A x = 0).
$$

另一方面, 显然 $(Ax = 0) \implies (A^TAx) = 0$.
{% endpf %}

{% endpro %}

## 稍难的题目

{% pro %}
假设 $A$ 是 $n \times m$ 规格的矩阵, $B$ 是 $m \times p$ 规格矩阵. 请证明,

$$
r(AB) + m \geq r(A) + r(B).
$$
提示: 如果你熟悉线性空间, 则可以从零解的角度思考问题. 只需证明

$$
(m-r(A)) \geq (p-r(AB)) - (p-r(B)).
$$

{% pf %}
简单地说, 左侧是 $A$ 零空间的维数, 右侧是 $A$ 的零空间中一切形如 $Bv$ 的向量所构成的空间的维数. 如果熟悉线性空间的语言, 题干中的不等式就是

$$
\dim N (A) \geq \dim (N(A) \cap C(B)).
$$

其中, $N(A) = \{x \mid Ax = 0\}$ 是 $A$ 的零空间, $C(B) = \{Bv \mid v \in \mathbb{R}^p\}$ 是 $B$ 的列空间.
\\
\\
也可以从阶梯形的角度解答问题, 请看以下技巧:

$$
\begin{align*}
r(AB) + m & = r\begin{pmatrix}AB & O\\ O&I\end{pmatrix} \\
(\text{作可逆列变换})\quad & = r\begin{pmatrix}AB & O\\ B&I\end{pmatrix} \\
(\text{作可逆行变换})\quad & = r\begin{pmatrix}O & -A\\ B&I\end{pmatrix} \\
& \geq r\begin{pmatrix}O & -A\\ B&O\end{pmatrix} \\
(\text{作可逆列变换})\quad & = r\begin{pmatrix}A&O\\ O&B\end{pmatrix} \\
& = r(A) + r(B).
\end{align*}
$$

{% endpf %}

{% endpro %}
