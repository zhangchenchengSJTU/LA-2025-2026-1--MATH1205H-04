---
title: HW23
author: Chenchen Zhang
layout: post
category: homework
---

## 投影矩阵

### 投影矩阵的性质

以下仅谈论实数域上的情况.

{% def %}
(投影矩阵). 称 $P \in \mathbb R^{n \times n}$ 是投影矩阵, 若

$$\begin{equation}
P^2 = P = P^T.
\end{equation}$$

{% enddef %}

特别注意, 我们将满足 $P^2 = P$ 的矩阵称作幂等矩阵, 将满足 $P^2 = P = P^T$ 的矩阵称作投影矩阵. 有些地方将满足 $P^2 = P$ 的矩阵称作投影矩阵, 将满足 $P^2 = P = P^T$ 的矩阵称作正交幂等矩阵.

{% ex %}
投影矩阵正交相似于一个对角矩阵, 其对角线元素仅为 $0$ 和 $1$.
{% endex %}

{% ex %}
解释 $P^2 = P$ 与 $P = P^T$ 的含义.

1. $P^2 = P$ 即 $P$ 幂等. 试想, 将向量 $v$ 投影到某子空间 $U$ 上, 则投影两次等于投影一次.
2. $P = P^T$ 即 $x^T(Py) = (Px)^Ty$ 恒成立. 试回顾中学课本对内积 $u\cdot v$ 的计算: 既可以计算 $u$ 在 $v$ 方向上的投影再乘以 $\|v\|$, 也可以计算 $v$ 在 $u$ 方向上的投影再乘以 $\|u\|$.

{% endex %}

{% pro %}
判断题 (假定所有矩阵是 $\mathbb R^{n \times n}$ 中的).

1. 若 $P$ 是投影矩阵, 则 $I - P$ 也是投影矩阵.
2. 投影矩阵的分量必须要有 $0$ 和 $1$.
3. 若 $P$ 是投影矩阵, 则 $\det(P)$ 必为 $0$ 或 $1$.
4. 若 $P$ 是投影矩阵, 则 $\dim C(P) = \mathrm{tr}(P)$.
5. 若 $P, Q$ 是投影矩阵, 则 $C(P+Q) = C(P) + C(Q)$, 此处 $C(\cdot)$ 表示列空间.
6. 若 $P, Q$ 是投影矩阵, 则 $N(P+Q) = N(P) \cap N(Q)$, 此处 $N(\cdot)$ 表示零空间.
7. 若 $P, Q$ 是投影矩阵, 则 $C(PQ) = C(P) \cap C(Q)$.
8. 若 $P, Q$ 是投影矩阵, 则 $N(PQ) = N(P) + N(Q)$.
9.  若 $P$ 是投影矩阵, 则 $N(I - P) = C(P)$.
10. 若 $P$ 是投影矩阵, 则全空间具有直和分解 $N(P) \oplus C(P)$.

{% endpro %}

{% pro %}
请用简单的反例说明以下事情:

1. 以下三个条件两两独立: $P^2 = P$, $P = P^T$, 以及 $P^2 = P^T$. 简单地说, 可以找到三个例子, 分别满足其中一个条件但不满足剩下两个条件.
2. $P$ 与 $Q$ 是投影矩阵, 但 $PQ$ 未必是投影矩阵.
3. $P$ 与 $Q$ 是投影矩阵, 但 $P+Q$ 未必是投影矩阵.
4. $P_1, P_2, P_3$ 是投影矩阵, 满足 $P_1P_2 = P_2P_1$ 与 $P_2P_3 = P_3P_2$, 但未必有 $P_3P_1 = P_1P_3$.

{% endpro %}

{% lem %}
若 $P, Q$ 是投影矩阵, 则以下条件等价.

1. $P+Q$ 是投影矩阵.
2. $PQ = O$.
3. $QP = O$.
4. $C(P) \perp C(Q)$.

{% pf %}
考虑转置, 2. 与 3. 等价. 式 $P^TQ = O$ 等价于 $C(P)\perp C(Q)$. 我们最后给出 $1 \leftrightarrow 2$ 的直接证明.
\\
($2 \to 1$). 假定 $PQ = O$, 则 $QP = O$. 显然 $(P+Q)^T = P^T + Q^T = P + Q$. 同时

$$\begin{equation}
(P+Q)^2 = P^2 + PQ + QP + Q^2 = P + O + O + Q.
\end{equation}$$

这说明 $P+Q$ 是投影矩阵.
\\
($1 \to 2$). 若 $P+Q$ 是投影矩阵, 则

$$\begin{equation}
P^2 + Q^2 = P+Q = (P+Q)^2 = P^2 + PQ + QP + Q^2.
\end{equation}$$

因此 $PQ =  -QP$. 注意到

$$\begin{equation}
PQ = PPQ = - PQP = QQP = QP,
\end{equation}$$

从而 $PQ=QP =O$.
\\
($4 \to 2$). 设 $u \in C(Q)$, 则 $u = Qv$ 对某 $v$ 成立. 由于 $C(P) \perp C(Q)$, 故 $Pu \perp u$. 因此

{% endpf %}

{% endlem %}

{% lem %}
若 $P, Q$ 是投影矩阵, 则以下条件等价.

1. $P-Q$ 是投影矩阵.
2. $PQ = Q$.
3. $QP = Q$.
4. $C(Q) \subseteq C(P)$.
5. $N(P) \subseteq N(Q)$.
6. $\|Px\| \geq \|Qx\|$ 对一切 $x$ 成立.

{% pf %}
前四条等价. 在 $P, Q$ 是投影矩阵的前提下, $P-Q$ 是投影矩阵当且仅当 $(I-P)+Q$ 是投影矩阵, 往后使用上一问的结论即可. 假设证明了判断题 $10$, 那么 $4$ 与 $5$ 等价. 最后证明 $6$ 与剩余条件等价.
\\
($1 \to 6$). 若 $P-Q$ 是投影矩阵, 则

$$\begin{equation}
\|Px\|^2 - \|Qx\|^2 = x^T(P^TP-Q^TQ)x = x^T(P-Q)x \geq 0
\end{equation}$$

($6 \to 5$). 显然.

{% endpf %}

{% endlem %}

{% lem %}
若 $P, Q$ 是投影矩阵, 则以下条件等价.

1. $PQ$ 是投影矩阵.
2. $PQ = QP$.
3. $P+Q-PQ$ 是投影矩阵.

{% pf %}
($2 \to 1$). 依定义直接验证即可.
\\
($3 \to 2$). $PQ = (PQ)^T = Q^TP^T=QP$.
\\
($1 \to 3$). 若 $PQ$ 是投影矩阵, 则 $PQ = (PQ)^T =QP$. 依照 $P^2=P$, $Q^2=Q$ 以及 $PQ=QP$, 可化简下式:

$$\begin{equation}
(P+Q - PQ)^2 = \cdots = P+Q - PQ
\end{equation}$$

以及有

$$\begin{equation}
(P+Q - PQ)^T = P^T + Q^T - (PQ)^T = P + Q - PQ.
\end{equation}$$

因此, $P+Q - PQ$ 是投影矩阵.

{% endpf %}

{% endlem %}

### 投影矩阵与子空间

{% thm %}
以下是双射

$$\begin{equation}
\mathbb R^{n\times n}\ \text{中的投影矩阵} \to \mathbb R^n\ \text{的子空间}, \quad P \mapsto C(P).
\end{equation}$$

{% pf %}
只需给出以上映射的逆. 即证, 给定子空间 $U$, 则存在唯一的投影矩阵 $P$ 使得 $C(P) = U$. 

1. (存在性). 存在 $U$ 的标准正交基 $\{u_1, u_2, \ldots, u_k\}$. 此时,

   $$\begin{equation}
   (u_1 \mid \cdots \mid u_k) \cdot (u_1 \mid \cdots \mid u_k)^T
   \end{equation}$$

   是以 $U$ 为列空间的投影矩阵.
2. (唯一性). 设 $P, Q$ 是投影矩阵, 且 $C(P) = C(Q) = U$. 将上述 $U$ 的标准正交基扩展为 $\mathbb R^n$ 的标准正交基 $\{u_1, \ldots, u_n\}$, 则恒有 $Pu_i = Qu_i$. 这说明 $P = Q$.

{% endpf %}

{% endthm %}

这说明, 子空间与投影矩阵一一对应.

### Moore-Penrose 广义逆

{% thm %}
(Moore-Penrose 广义逆). 给定矩阵 $A \in \mathbb R^{m \times n}$, 则存在唯一的矩阵 $A^+ \in \mathbb R^{n \times m}$, 满足

1. $A A^+ A = A$,
2. $A^+ A A^+ = A^+$,
3. $(A A^+)^T = A A^+$,
4. $(A^+ A)^T = A^+ A$.

{% pf %}
若 $D$ 是可逆的对角矩阵, 容易证明 $\begin{pmatrix}D&O \\ O&O\end{pmatrix}^+ = \begin{pmatrix}D^{-1}&O \\ O&O\end{pmatrix}$.

1. $A^+$ 的存在性. 记 $A$ 的奇异值分解为 $A = U \Sigma V^T$. 则取 $A^+ = V \Sigma^+ U^T$ 即可.
2. $A^+$ 的唯一性. 设 $B,C$ 都满足上述四个条件. 则

   $$\begin{aligned}
   B & = BAB\\
   & = A^TB^TB\\
   & = A^TC^TA^TB^TB\\
   & = A^TC^TBAB\\
   & = A^TC^TB\\
   & = CAB\\
   & = CB^TA^T\\
   & = CACB^TA^T\\
   & = CC^TA^TB^TA^T\\
   & = CC^TA^T\\
   & = CAC \quad = C.
   \end{aligned}$$

{% endpf %}

{% endthm %}

{% prop %}
直接地, $A$ 的广义逆等于

$$\begin{equation}
\lim_{t \to 0} (A^TA + tI)^{-1} A^T.
\end{equation}$$

备注.

1. 对 $A$ 作奇异值分解知, 以上极限存在.
2. $(A^TA + tI)^{-1} A^T = A^T (AA^T + tI)^{-1}$.

{% endprop %}

{% ex %}
以下性质容易验证.

1. 若 $A$ 可逆, 则 $A^+ = A^{-1}$.
2. $(A^T)^+ = (A^+)^T$.
3. $(A^+)^+ = A$.
4. $AA^+$ 是投影矩阵, 投影至 $C(A)$; $I-AA^+$ 是投影矩阵, 投影至 $N(A^T)$.
4. $A^+A$ 是投影矩阵, 投影至 $C(A^T)$; $I - A^+A$ 是投影矩阵, 投影至 $N(A)$.
5. $(A \mid B)(A \mid B)^+$ 是投影矩阵, 列空间是 $C(A) + C(B)$.
6. $2AA^T(AA^T+BB^T)^+BB^+$ 是投影矩阵, 列空间是 $C(A) \cap C(B)$.

{% endex %}

{% pro %}
回顾线性方程组 $Ax = b$.

1. 简要说明, 方程组有解当且仅当 $AA^+ b = b$.
2. 假定方程组有解, 则解必然形如 $A^+b + (I - A^+A)y$. 此处 $y$ 是任意向量.
3. 假定方程组有解, 则方程组有唯一解当且仅当 $A^+A = I$.

{% endpro %}