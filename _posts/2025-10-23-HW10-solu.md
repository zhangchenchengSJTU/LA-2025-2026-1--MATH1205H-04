---
title: HW10-solu
author: Chencheng Zhang
layout: post
category: solution
---

**所有矩阵都是数域上的. 试完成 Problems.**

## (带主元选取的) LU 分解

{% pro %}
(可逆方阵的 LU 分解). 试依次证明如下问题.

1. 记方阵 $Q$ 的第 $k$ 个顺序主子式为左上角 $k \times k$ 部分. 假定 $Q \in \mathbb F^{n \times n}$ 的 $n$ 个顺序主子式可逆. 试证明, 存在行初等变换 $(Q \mid I) \to (U \mid L)$ 使得 $U$ 是上三角矩阵, $L$ 是下三角矩阵且对角线元素均为 $1$. 此时, $Q = L^{-1} U$ ($L^{-1}$ 也是主对角为 $1$ 的下三角矩阵).
2. 假定 $n \times (n+1)$ 规格的矩阵 $A$ 行满秩, 则可以移除 $A$ 某列, 使得移除后的 $n \times n$ 矩阵可逆.
3. 试证明任意可逆矩阵 $Q \in \mathbb F^{n \times n}$ 都可以写作 $Q = LUS$, 其中 $L$ 是下三角矩阵且对角线元素均为 $1$, $U$ 是上三角矩阵, $S$ 是置换矩阵.
4. 简单说明, 并非所有可逆矩阵都能写作 $Q = LU$ 的形式.
5. 可逆矩阵 $Q$ 能写作 $Q = LU$, 当且仅当 $Q$ 的所有顺序主子式均可逆.

{% pf %}
(问题 1). 行变换方式:

$$\begin{equation}
(Q\mid I) = \left(\begin{pmatrix}
    Q_1 & \ast\\\ast&\ast
\end{pmatrix}\mid \begin{pmatrix}
    I & O\\ O& 1
\end{pmatrix}\right) \to \left(\begin{pmatrix}
    Q_1 & \ast\\ 0&\ast
\end{pmatrix}\mid \begin{pmatrix}
    I & O\\ \ast & 1
\end{pmatrix}\right) \to \cdots.
\end{equation}$$

(问题 2). $ref(A)$ 仅在某一列不换行. 移除该列即可.
\\
(问题 3). 在问题 1 的算法中, 可能出现顺序主子式不可逆的情况, 例如 $\begin{pmatrix} Q_k & \ast\\ O&\ast\end{pmatrix}$ 中 $Q_k$ 不可逆. 依照上一问, 可以适当交换 $(Q_k \mid \ast)$ 的列, 使得左侧矩阵可逆. 继续进行问题 1. 的算法即可, 出现问题时只需右乘置换矩阵交换列即可.
\\
(问题 4). 容易验证 $\begin{pmatrix} 0&1\\1&0 \end{pmatrix}$ 是反例.
\\
(问题 5). 方向 $\gets$ 已在前文证明. 反之, 若 $Q = LU$, 下证明 $Q$ 左上角 $k \times k$ 子式可逆. 记 $Q = \begin{pmatrix} L'&O\\\ast &L'' \end{pmatrix}\begin{pmatrix} L'&\ast\\ O &L'' \end{pmatrix}$, 则子式 $L' U''$ 是可逆矩阵的乘积, 故可逆.

{% endpf %}

{% endpro %}

{% cor %}
作为推论, 任意矩阵 $A \in \mathbb F^{m \times n}$ 可以写作乘积 $A = LRS$. 其中,

1. $L\in \mathbb F^{m \times m}$ 是下三角矩阵, 且对角线元素均为 $1$;
2. $R\in \mathbb F^{m \times n}$ 是阶梯形状的矩阵 (上三角矩阵在非方阵中的推广);
3. $S\in \mathbb F^{m \times m}$ 是置换矩阵.

{% endcor %}

{% cor %}
作为推论, 所有矩阵 $A \in \mathbb F^{m \times n}$ 可以写成乘积 $A = LJDUS$, 其中

1. $L\in \mathbb F^{m \times m}$ 是下三角矩阵, 且对角线元素均为 $1$;
2. $J\in \mathbb F^{m \times n}$ 是形如 $\binom{I \ \ O}{O \ \ O}$ 的矩阵;
3. $D\in \mathbb F^{n \times n}$ 是对角矩阵, 且对角线元素均非零;
4. $U\in \mathbb F^{n \times n}$ 是上三角矩阵, 且对角线元素均为 $1$;
5. $S\in \mathbb F^{m \times m}$ 是置换矩阵.

{% endcor %}

{% ex %}
可使用 [sage](https://sagecell.sagemath.org/) 查看一个矩阵的 $ref$ 型与 $PA = LU$ 分解. 例如, 我们创建 $\mathbb Q$ 上的矩阵

```python
A = matrix(QQ, [
 [ 1, 1, 4, 5, 1, 4, 0, 0, 1],
 [-1, 9,-1,-9, 8,-1, 0,-7,-7],
 [ 1, 2,-3,-4, 5, 6,-7,-8, 9],
 [ 3, 1, 4, 1, 5, 9, 2, 6, 5],
 [ 2, 7, 1, 8, 2, 8, 1, 8, 3]
 ]); # Create $A\in \mathbb Q^{m\times n}$
```

可以使用 `A.rref()` 计算 $A$ 的行最简形, 使用 `P, L, U = A.LU()` 计算 $PA = LU$ 分解, 其中 `P` 是置换矩阵.

{% endex %}

## 矩阵与映射

行满秩矩阵的列数不少于行数. 请用尽量简洁的语言证明如下问题.

{% pro %}
$A \in \mathbb F^{m \times n}$ 行满秩, 当且仅当以下等价命题成立:

1. (行满秩的定义). $ref(A)$ 的每一行都有主元, 即不存在零行.
2. $cef(A) = (I_m \quad O)$.
3. $\mathbb F^m$ 的任意向量都能由 $A$ 的列向量线性组合得到.
4. 列向量的映射 $\begin{bmatrix}\mathbb F^n &\to& \mathbb F^m \\ v &\mapsto& A\cdot v\end{bmatrix}$ 是满射.
5. 存在 $R$ 使得 $AR = I_m$.
6. $A$ 行线性无关.
7. 行向量的映射 $\begin{bmatrix}\mathbb F^{1\times m} &\to& \mathbb F^{1 \times n} \\ u^T &\mapsto& u^T\cdot A \end{bmatrix}$ 是单射.

{% pf %}
($1 \leftrightarrow 2$). 因为行秩等于列秩.
\\
($2 \leftrightarrow 3$). $A$ 与 $cef(A)$ 可通过可逆列变换互化. 所以可以将条件 3 的 $A$ 换成 $cef(A)$. 条件 3 成立, 当且仅当 $cef(A)$ 的主元能填满所有行, 当且仅当条件 2 成立.
\\
($3 \leftrightarrow 4$). 这是自然语言和映射语言的等价表述. 试回顾: $Ax$ 表示以 $x$ 为系数对 $A$ 的列向量进行线性组合.
\\
($4 \leftrightarrow 5$). 回顾矩阵乘法的基本规律 $A (u \mid v) = (Au \mid Av)$. 从而 $\begin{bmatrix}\mathbb F^n &\to& \mathbb F^m \\ v &\mapsto& A\cdot v\end{bmatrix}$ 是满射, 当且仅当 $\begin{bmatrix}\mathbb F^{n \times m} &\to& \mathbb F^{m \times m} \\ v &\mapsto& A\cdot v\end{bmatrix}$ 是满射, 这也当且仅当 $I_m$ 属于映射的像, 当且仅当 存在 $R$ 使得 $AR = I_m$.
\\
($2 \leftrightarrow 6$). 可逆列变换不改变行线性关系. $A$ 行线性无关, 当且仅当 $cef(A)$ 行线性无关, 当且仅当 $cef(A) = (I_m \quad O)$.
\\
($6 \leftrightarrow 7$). 条件 6 等价于说, $A$ 的非零行线性组合是非零的, 用映射语言等价表述, 得条件 7.
{% endpf %}

{% endpro %}

{% cor %}
从映射角度看, 若 $A$ 和 $B$ 行满秩, 则 $AB$ 行满秩. 若 $AB$ 行满秩, 则 $A$ 行满秩.
{% endcor %}

{% pro %}
给定矩阵 $B \in \mathbb F^{m \times m}$ 与 $C \in \mathbb F^{n \times n}$.

1. 假定矩阵方程 $BXC = O$ 的解仅有 $X = O$, 则任何 $\mathbb F^{m \times n}$ 中的矩阵 $Y$ 都能写作 $Y = BXC$ 的形式.
2. 假定矩阵方程 $BX = XC$ 的解仅有 $X = O$, 则任何 $\mathbb F^{m \times n}$ 中的矩阵 $Y$ 都能写作 $Y = BX - XC$ 的形式.

提示: 试回顾对方阵 $A$, 存在映射

$$\begin{equation}
\begin{bmatrix}\mathbb F^n &\to& \mathbb F^n \\ v &\mapsto& A\cdot v\end{bmatrix}
\end{equation}$$

这是单射 ($A$ 列满秩), 当且仅当这是满射 ($A$ 行满秩), 当且仅当这是双射 ($A$ 可逆).

{% pf %}
以问题 1 为例. $BXC = O$ 是一个线性方程组, 未知元是 $x_{i,j}$, 未知元的系数由 $B$ 和 $C$ 给定, 且未知元数量等于方程数量. 我们发现

- 任何线性方程组都能写作 $Ax = b$ 的形式. 若未知元数量等于方程数量, 则 $A$ 是方阵. $Ax = 0$ 有唯一解, 当且仅当 $A$ 列满秩, 当且仅当 $A$ 行满秩, 当且仅当对任意 $b$, $Ax = b$ 有解.

问题 2 类似.
{% endpf %}

{% endpro %}
