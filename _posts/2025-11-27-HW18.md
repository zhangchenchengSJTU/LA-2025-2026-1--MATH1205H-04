---
title: HW18
author: Chencheng Zhang
layout: post
category: homework
---

## 空间的正交性

### Euclidean 距离

{% def %}
(距离函数). 集合 $X$ 上的一种距离函数是一个二元映射

$$\begin{equation}
d : X \times  X \to [0,+\infty),\quad (x,y) \mapsto d(x,y)
\end{equation}$$

且满足以下三条性质:

1. 对任意 $x,y \in X$, $d(x,y) = 0$ 当且仅当 $x=y$;
2. 对任意 $x,y \in X$, $d(x,y) = d(y,x)$;
3. 对任意 $x,y,z \in X$, $d(x,z) \leq d(x,y) + d(y,z)$.

{% enddef %}

{% ex %}
集合 $\mathbb R^n$ 上存在很多种类的距离函数. 最常用的是

$$\begin{equation}
\mathbb R^n \times \mathbb R^n \to [0,+\infty),\quad (x,y) \mapsto \sqrt{\sum_{i=1}^n (x_i - y_i)^2}.
\end{equation}$$

容易验证这是一个距离函数. 我们将这一函数称作 Euclidean 距离函数.

{% endex %}

{% def %}
对大小相同的列向量 $u$ 与 $v$, 记 $\braket{x,y} := x^Ty$. 记 $\|x\| := \sqrt{\braket{x,x}}$ 是向量 $x$ 的模长.
{% enddef %}

{% ex %}
选定 $\mathbb R^n$. 试验证以下式子:

1. 对任意 $x$, 函数 $\braket{x,-} : \mathbb R^n \to \mathbb R,\quad y \mapsto \braket{x,y}$ 是线性的;
2. 对任意 $y$, 函数 $\braket{-,y} : \mathbb R^n \to \mathbb R,\quad x \mapsto \braket{x,y}$ 是线性的;
3. $\braket{x,y} = \frac{1}{2}(\|x+y\|^2 - \|x\|^2 - \|y\|^2)$;
4. $\braket{x,y} = \frac{1}{4}(\|x+y\|^2 - \|x-y\|^2)$;
5. $2\|x\|^2 + 2\|y\|^2 = \|x+y\|^2 + \|x-y\|^2$.

{% pf %}
高中题.
{% endpf %}

{% endex %}

{% pro %}
证明以下等价:

1. $\braket{u,v} = 0$;
2. $\|u\| \leq \|u + \lambda v\|$ 对任意 $\lambda \in \mathbb R$ 成立.

并说明其几何意义.

{% endpro %}

### 正交补

{% def %}
(正交补). 选定 $\mathbb R^n$, 考虑 Euclidean 距离函数 $\braket{-,-}$. 定义子空间 $V$ 的正交补为

$$\begin{equation}
V^\perp := \{x \in \mathbb R^n \mid \braket{x,y} = 0,\ \forall y \in V\}.
\end{equation}$$

显然 $V^\perp$ 也是线性子空间.

{% enddef %}

{% lem %}
对任意子空间 $V$, 总有 $\mathbb R^n = V \oplus V^\perp$.

{% pf %}
先证明 $V \cap (V^\perp) = 0$. 任取 $x \in V \cap (V^\perp)$, 则有 $\braket{x,x} = 0$. 因此 $x = 0$.
\\
再证明 $\dim V + \dim V^\perp = n$. 假定 $V$ 是列满秩矩阵 $M_{n \times r}$ 的列空间, 则 $V^\perp = N(M^T)$. 最后使用线性代数基本定理即可.
\\
综上, $\mathbb R^n = V \oplus V^\perp$.
{% endpf %}

{% endlem %}

{% cor %}
将四大基本空间统一写作列向量. 矩阵的零空间 $N(A)$ 与行空间 $C(A^T)$ 互为正交补, 左零空间 $N(A^T)$ 与列空间 $C(A)$ 互为正交补.

{% endcor %}

{% lem %}
以下映射是双射

$$\begin{equation}
(-)^\perp :\quad \text{$\mathbb R$ 的子空间} \to  \text{$\mathbb R$ 的子空间},\quad V \mapsto V^\perp.
\end{equation}$$

{% pf %}
只需证明 $((-)^\perp)^\perp$ 是恒同映射. 由定义知 $V \subseteq (V^\perp)^\perp$. 由维数知 $\dim V = \dim (V^\perp)^\perp$. 从而 $V = (V^\perp)^\perp$.
{% endpf %}

{% endlem %}

{% pro %}
假定 $U$ 与 $V$ 是 $\mathbb R^n$ 的子空间. 证明 $(U \cap V)^\perp = (U^\perp) + (V^\perp)$.
{% endpro %}

### 例子: Farkas 理论

Farkas 理论可简单视作 Fredholm 理论在 Euclidean 空间上的推广.

{% thm %}
(Fredholm 二择). 对任意域 $\mathbb F$, 以下有且仅有一者发生:

1. $Ax = b$ 有解,
2. $y^T (A \mid b) = (0^T \mid 1)$ 有解.

{% pf %}
下证明 $Ax = b$ 无解当且仅当 $y^T (A \mid b) = (0^T \mid 1)$ 有解. 记 $ref(A \mid b) = (ref(A) \mid b')$, 则

- $y^T (A \mid b) = (0^T \mid 1)$ 有解, 当且仅当
- $z^T (ref(A) \mid b') = (0^T \mid 1)$ 有解,
- 当且仅当 $b'$ 在 $ref(A)$ 的零行所在行有非零取值,
- 当且仅当 $r((A \mid b)) > r(A)$,
- 当且仅当 $Ax = b$ 无解.

{% endpf %}

简单地说, 从横, 竖两种方向观察阶梯形即可.

{% endthm %}

以下选定实数域上的矩阵与向量. 约定:

- 称向量 $v$ 是非负的, 若 $v$ 中每一项都是非负的, 记作 $v \geq 0$,
- 称向量 $v$ 是正的, 若 $v$ 中每一项都是正的, 记作 $v > 0$,
- ...

{% thm %}
(Farkas 二择). (试比较 Fredholm 二择的表述). 以下有且仅有一者发生:

1. $Ax = b$ 有非负解,
2. 存在非正向量 $u$ 使得 $y^T (A \mid b) = (u^T \mid 1)$ 有解.

{% pf %}
显然两者无法同时成立. 只需证明, 若 1. 不成立, 则 2. 成立. 实际上, 可以构造具体的 $y$.
\\
**Step 1** 记 $S= \{A y \mid y \geq 0\}$. 由于 1. 不成立, 得 $b \notin S$. 考虑 $b$ 与 $S$ 中各点的距离, 下证明存在 $x_0 \in S$ 使得 $b$ 到 $x_0$ 距离最短, 且 $x_0$ 唯一.

1. (存在性). 试回忆数学分析: $\inf_{x\in S}\|x-b\|$ 存在, 但 $\min_{x\in S}\|x-b\|$ 未必能定义. 记 $\inf_{x\in S}\|x-b\| = D$, 则对任意 $n$, 闭球 $B(b,D+n^{-1})$ 与 $S$ 的交 $B(b,D+n^{-1}) \cap S$ 是非空闭集. 由闭集套定理, $\bigcap_{n \geq 1} (B(b,D+n^{-1}) \cap S) \neq \varnothing$. 该集合中的点即为所求.
2. (唯一性). 假定存在 $x_0, x_0' \in S$ 符合条件, $x_0 \neq x_0'$. 容易发现 $\frac{1}{2}(x_0 + x_0') \in S$. 由极化恒等式, $\frac{1}{2}(x_0 + x_0')$ 距 $b$ 更近, 矛盾.

**Step 2** 由以上, 可微函数 $\|Ax - b\|^2$ 在 $x = x_0$ 处取最小值. 对 $1 \leq k \leq n$, 有以下两种情况:

- (Case I). $(x_0)_k > 0$, 且 $\frac{\partial}{\partial x_k}|_{x_k = (x_k)_0}(\|Ax-b\|^2) = 0$;
- (Case II). $(x_0)_k = 0$, 且 $\frac{\partial}{\partial x_k}|_{x_k = (x_k)_0}(\|Ax-b\|^2) \geq 0$.

整理得以下结论: 式 $(x_0)_k$ 与 $\braket{Ax_0-b, Ae_k}$ 中恰好一者为 $0$, 另一者为负.
\\
**Step 3** 记 $y = (b-Ax_0)$. 由 **Step 2** 得 $y^TA \leq 0$. 另一方面,

$$\begin{aligned}
y^Tb &= \braket{b-Ax_0,b}\\
&= \braket{b-Ax_0,b-Ax_0} + \braket{b-Ax_0,Ax_0}\\
&= \|b-Ax_0\|^2 + \sum_{i=1}^n (x_0)_i \braket{b-Ax_0,Ae_i}\\
&> 0 + 0 = 0.
\end{aligned}$$

对 $y$ 乘以适当的常数, 得到 $y^T (A \mid b) = (u^T \mid 1)$, 其中 $u \leq 0$.

{% endpf %}

该定理存在 analysis-free 的简单证明, 但需要凸优化学科的知识, 此处从略.

{% endthm %}

{% cor %}
Farkas 二择的自然语言表述如下: $A$-列向量的非负线性组合无法表示 $b$, 当且仅当这一方程组能通过行变换得到

$$\begin{equation}
c_1 x_1 + c_2 x_2 + \cdots + c_n x_n = d,\quad d > 0,\quad c_i \leq 0.
\end{equation}$$

{% endcor %}

{% cor %}
对任意子空间 $U \subseteq \mathbb R^n$, 有且仅有一者成立:

1. 存在非负向量 $x \in U$, $x$ 的最后一项为正数;
2. 存在非负向量 $x \in U^\perp$, $x$ 的最后一项为正数.

{% endcor %}

{% cor %}
若 $U$ 中的任意非零向量既有正项也有负项, 则 $U^\perp$ 中存在正的向量.
{% endcor %}

## 正交矩阵

### 基本定义

{% def %}
(正交矩阵). 矩阵 $Q$ 称作正交矩阵, 若线性映射

$$\begin{equation}
\varphi : \mathbb R^n \to \mathbb R^n,\quad x \mapsto Qx
\end{equation}$$

满足 $\|x\| = \|Qx\|$.
{% enddef %}

{% ex %}
由定义, 旋转矩阵是正交的.
{% endex %}

{% lem %}
实方阵 $Q$ 是正交的, 当且仅当 $Q^TQ = I$.

{% pf %}
$\|x\| = \|Qx\|$ 恒成立, 当且仅当

$$\begin{equation}
0 = \braket{Qx,Qx}-\braket{x,x} = x^T (Q^TQ - I) x,\quad \forall x.
\end{equation}$$

对实对称矩阵 $A$, $A=O$ 当且仅当 $x^TAx = 0$ 恒成立.

{% endpf %}

{% endlem %}

特别注意: 有些地方将满足 $Q^TQ = \lambda I$ 的矩阵也称作正交矩阵.

{% ex %}
假定所有矩阵是 $\mathbb R^{n \times n}$ 中的. 以下是一些基本事实.

1. 正交矩阵的行列式是 $\pm 1$.
2. $Q$ 是正交矩阵, 当且仅当 $Q^{-1} = Q^T$.
3. 两个正交矩阵相乘还是正交矩阵.
4. 正交矩阵的转置也是正交矩阵.
5. 正交矩阵的逆矩阵也是正交矩阵.
6. 正交矩阵的 $\mathrm{Adj}$-矩阵也是正交矩阵.
7. 置换矩阵是正交矩阵.
8. 若 $B=-B^T$ 则 $I+B$ 可逆, 且 $(I-B)(I+B)^{-1}$ 是正交矩阵.

{% endex %}

{% pro %}
假定 $Q$ 是正交矩阵. 记 $Q'$ 是 $Q$ 左上方的 $(k\times k)$-子式. 假定 $\lambda$ 是 $Q'$ 在复数域上的特征值, 则 $|\lambda| \leq 1$.
{% endpro %}

### 例子: 实矩阵的正交对角化

{% pro %}
给定实对称矩阵 $A$. 试依次证明以下命题, 或直接证明 4..

1. 试证明 $A$ 的 Jordan 标准型是对角矩阵, 且对角元是实数.
2. 证明存在实矩阵 $P$ 使得 $PAP^{-1}$ 是对角矩阵 $D$.
3. 接上问. 若 $D$ 的特征值两两不同, 则存在正交矩阵 $Q$ 使得 $Q^{-1}AQ = D$.
4. 接上问. 若不对 $D$ 的特征值作任何要求, 则仍存在正交矩阵 $Q$ 使得 $Q^{-1}AQ = D$.

{% endpro %}