---
title: HW22
author: Chenchen Zhang
layout: post
category: homework
---

## 最小平方法

最小平方法 (英文: Least Squares Method, 日文: 最小二乗法 (さいしょうにじょうほう)) 用于拟合线性方程组的解, 其基本思想是通过最小化误差平方和来找到最佳拟合线性模型. **以下所有问题都是实数域上的**.

### 线性方程组的解

方程 $Ax = b$ 未必有解. 我们退而求其次地寻找一个 $y$ 使得 $Ay$ 与 $b$ 的距离最小, 相应的误差即

$$\begin{equation}
\min_{y} (Ay - b)^T (Ay - b).
\end{equation}$$

{% ex %}
我们求解方程 $\binom 12x = \binom 11$ (记作 $Ax = b$). 从几何意义上看, $A$ 的列空间即过原点的直线 $\{(t,2t) \mid t \in \mathbb R\}$. 试回顾, 解方程即用 $A$ 的列向量表示 $b$. 此处 $b$ 不属于直线, 因此 $Ax = b$ 无解. 我们退而求其次地寻找一个 $y$ 使得 $Ay$ 与 $b$ 的距离最小, 即求解

$$\begin{equation}
\min_{y} (Ay - b)^T (Ay - b) = \min (y-1)^2 + (2y - 1)^2.
\end{equation}$$

取达到的最小值即误差.

{% endex %}

我们需要解释分析学中的问题:

1. 由实数的完备性, 我们总是可以放心地写 $\inf$; 但是 $\min$ 未必存在. 若能说明 $\min$ 存在, 则 $\min = \inf$.
2. 当取达到最小值时, $y$ 的取值是唯一的吗? 也就是说, 是否存在多个 $y$ 使得 $\|Ay - b\| \min \|Ax - b\|$?

试证明以下问题.

{% pro %}
给定真子空间 $U \subseteq \mathbb R^n$ 与子空间外的一点 $v \notin U$. 证明:

1. 存在 $u \in U$ 使得 $\|v - u\| = \inf_{u' \in U} \|v - u'\|$.
2. 以上 $u$ 是唯一的.
3. 从类似垂线段的角度解释其几何意义.

{% endpro %}

SVD 分解可以让我们看清这一分解这一问题.

{% ex %}
记奇异值分解 $A = U\Sigma V^T$, 则方程 $Ax = b$ 与 $\Sigma V^Tx = U^Tb$ 同解. 之所以使用 SVD 而非相抵标准型, 是因为左乘 $V$ 与 $U$ 保持长度等几何信息, 即 $\|V^Tx\| = \|x\|$ 与 $\|U^T b\| = \|b\|$ 成立.
{% endex %}

{% lem %}
若 $\|Ax_0 - b\| = \min_x \|Ax - b\|$, 则 $A^TAx_0 = A^Tb$.

{% pf %}
记函数

$$\begin{equation}
f : \mathbb R^n \to \mathbb R, \quad f(x) = (Ax-b)^T (Ax - b).
\end{equation}$$

$f$ 是一个多元多项式函数. 观察二次项系数, $f$ 在 $\|x\|$ 充分大时一致地趋向无穷大, 从而 $f$ 存在极小值. 假定 $f$ 在 $y_0$ 处取最小值, 则我们使用熟悉的 $\varepsilon$-$\delta$ 语言描述之:

- 对任意 $\varepsilon >0$, 存在 $\delta >0$, 使得对一切 $t \in (0,\delta)$ 与单位向量 (即模长为 $1$ 的向量) $u$, 总有 $f(y_0+ t u) \geq f(y_0)$.

作减法, 应有

$$\begin{equation}
f(y_0 + t u) - f(y_0) = 2t (A y_0 - b)^T A u + t^2 (Au)^T (Au) \geq 0.
\end{equation}$$

这说明一次项系数 $(A y_0 - b)^T A u$ 恒为 $0$. 由 $u$ 的任意性, 只能有 $A^T (A y_0 - b) = 0$, 即 $A^TA y_0 = A^Tb$.

{% endpf %}

{% endlem %}

{% cor %}
若 $A^TA x = bx$ 有唯一解 (例如 $A$ 列满秩), 则该解就是最小平方法的解.
{% endcor %}

{% pro %}
求最小平方法的解与误差.

$$\begin{equation}
\begin{pmatrix}
  1 & 0 & 0\\
  1 & 1 & 1\\
  1 & 2 & 4\\
  1 & 3 & 9
\end{pmatrix}
\cdot \begin{pmatrix}
  c \\ b\\ a
\end{pmatrix} = \begin{pmatrix}
  1\\-1\\2\\4
\end{pmatrix}.
\end{equation}$$

{% endpro %}

{% ex %}
给定映射

$$\begin{equation}
\varphi : \{0,1,2,3\} \to \mathbb R,\quad \begin{bmatrix}
0 & \mapsto & 1\\
1 & \mapsto & -1\\
2 & \mapsto & 2\\
3 & \mapsto & 4
\end{bmatrix}.
\end{equation}$$

我们希望使用二次函数 $f(x) = a x^2 + b x + c$ 拟合该映射, 即使得 $f(i)$ 尽可能接近映射在 $\varphi (i)$, ($i = 0,1,2,3$). 不难理解 $(a,b,c) = (a_0,b_0,c_0)$ 即为所求.
{% endex %}

### 函数拟合

以下考虑 $[0, 2 \pi] \to \mathbb R$ 类型的 (连续) 函数.

{% def %}
(函数的模长, 点乘). 给定函数 $f : [0, 2\pi] \to \mathbb R$, 定义其模长为

$$\begin{equation}
\|f\| = \sqrt{\int_0^{2\pi} f^2(x) \, dx}.
\end{equation}$$

点乘由极化恒等式定义:

$$\begin{equation}
\braket{f,g} = \frac{1}{4} \left( \|f+g\|^2 - \|f-g\|^2 \right) = \int_0^{2\pi} f(x) g(x) \, dx.
\end{equation}$$

{% enddef %}

{% ex %}
也可以将模长定义为 ${\int_0^{2\pi} |f(x)| \, dx}$, 但这会使得点乘运算难以定义.
{% endex %}

{% ex %}
容易验证 $\sin x \perp \sin 2x$. 以及 $\braket{x,3x} = 8\pi^3$.
{% endex %}

{% ex %}
可以对线性无关组 $\{1,x,x^2,x^3,\ldots \}$ 作[正交化运算](HW19#正交化). 由正交化结论, 存在一组多项式 $\{f_0, f_1, f_2, \ldots\}$ ($f_n$ 次数为 $n$) 使得 $f_i \perp f_j$ ($i \neq j$). 此处省略计算过程, 因为我们的重点不是多项式.

{% endex %}

{% ex %}
可以对线性无关组 $\{1, \cos x, \cos^2 x, \cos ^3 x, \ldots\}$ 作[正交化运算](HW19#正交化). 由分析学常识, 结果是

$$\begin{equation}
1, \cos x, \cos 2x, \cos 3x, \ldots.
\end{equation}$$

若考虑模长为 $1$, 则结果是

$$\begin{equation}
\frac{1}{\sqrt {2\pi}}, \frac{1}{\sqrt \pi} \cos x, \frac{1}{\sqrt {\pi}} \cos 2x, \frac{1}{\sqrt {\pi}} \cos 3x, \ldots.
\end{equation}$$

{% endex %}

{% pro %}
记 $f(x) = (\pi-x)$. 请使用最小平方法解方程

$$\begin{equation}
(1\mid \cos x \mid \cos 2x \mid \cos 3x) \cdot \begin{pmatrix}
  a \\ b \\ c \\ d
\end{pmatrix} = f(x).
\end{equation}$$

并将 $a_0 + b_0 \cos x + c_0 \cos 2x+ d_0 \cos 3x$ 与 $f(x)$ 作图比较.

{% endpro %}

