---
title: Exersice Class 8
author: Chencheng Zhang
layout: post
category: ExerciseClass
---

## Files

录制：09-Nov-25 线性代数习题课

日期：2025-11-09 18:00-21:00

录制文件：[地址](
https://pan.sjtu.edu.cn/web/share/afff28eaa01a24570243ac19d6d2beaa)

文档: [地址](https://zhangchenchengsjtu.github.io/MATH1205H-04-HW/assets/PDF/2025-11-09-%E7%AC%AC%E5%85%AB%E5%91%A8%E4%B9%A0%E9%A2%98%E8%AF%BE.pdf)

## 习题课思考题

{% pro %}
记 $A \in \mathbb R^{n \times n}$. 假定 $R$ 是对角元为 $0$, 剩余位置为 $1$ 的矩阵. 若 $A+A^T = R$, 试证明 $r(A) \geq n-1$.

{% pf %}
只需证明 $r(\binom {1^T}A) = n$. 此时, 删去一行后即有 $r(A) \geq n-1$. 记 $x \in N(\binom {1^T}A)$. 则 $1^Tx = 0$, 同时 $Ax = 0$. 注意到

$$\begin{equation}
0 = x^T Ax+x^T A^T x = x^T R x = x^T(11^T - I)x = -x^Tx,
\end{equation}$$

得 $x=0$. 因此 $r(\binom {1^T}A) = n$.

{% endpf %}

{% endpro %}

{% pro %}
记 $A \in \mathbb R^{n \times n}$. 假定 $A$ 的对角元素和 $tr(A):= \sum_{i=1}^na_{i,i} = 0$, 则存在 $X,Y \in A$ 使得 $A = XY - YX$.

{% pf %}
记 $\Lambda$ 是 $A$ 的对角部分. 此时存在置换矩阵 $P$ 与对角元相异的对角阵 $D$, 使得 $P^{-1}DP - D = \Lambda$.

- 这相当于说, 给定一个相加为 $0$ 的数组 $(\lambda_1,\lambda_2,\ldots,\lambda_n)$, 则存在一个元素两两相异的数组 $(d_1, d_2, \ldots, d_n)$ 与置换 $\tau$, 使得 $d_{\tau(i)} - d_i = \lambda_i$ 对任意 $i$ 成立.

取 $A = L-U$, 使得 $(L-D)$ 是对角为 $0$ 的下三角矩阵, $U$ 是上三角矩阵. 依照构造, $L$ 是对角元两两不同的矩阵, $U$ 与 $D$ 亦然. 依照 $P^{-1}DP - D = \Lambda$, 则 $L$, $D$ 与 $U$ 三者的对角元在相差一个置换的意义下相同. 依照相似对角化, 存在可逆矩阵 $Q,R$ 使得 $R^{-1}LR = S^{-1}US = D$. 这说明

$$\begin{equation}
A = L-U = (RS^{-1})\cdot (SR^{-1}L) - (SR^{-1}L)\cdot(RS^{-1}).
\end{equation}$$

- *问题: 能否避免使用相似矩阵, 找到更直接的证法?*

{% endpf %}

{% endpro %}

## 期中考试试题分析

**注意 1: 本试卷所有问题均属于实数域.**

### 致谢

感谢滕伟和曾楚笑协助编辑本答案, 有问题找他们就行. (实际上, T1-9 还真有问题.)

### T1 判断题

- 总结: 3, 4, 6, 7, 8, (9), 10 正确.

考虑以下 10 个命题:

(1) 若 $A,B,C$ 是同阶方阵且满足 $AB = AC$, 则 $A=O$ 或 $B=C$.

{% sol %}
错误! 反例: 设 $A = \begin{pmatrix}1 & 0 \\ 0 & 0\end{pmatrix}, B = \begin{pmatrix}0 & 0 \\ 1 & 0\end{pmatrix}, C = O$. 则 $AB = AC = O$, 但 $A \neq O$ 且 $B \neq C$.
{% endsol %}

(2) 方程 $Ax = b$ 有唯一解 $\iff$ $A$ 列满秩.

{% sol %}
错误! 反例: 设 $A = \begin{pmatrix}1 \\ 0\end{pmatrix}, b = \begin{pmatrix}0 \\ 1\end{pmatrix}$. 则 $A$ 列满秩, 但 $Ax = b$ 无解.
{% endsol %}

(3) 设 $A,B$ 为同阶方阵, 则 $AB$ 可逆 $\iff$ $A,B$ 均可逆.

{% sol %}
正确! 检验略.
{% endsol %}

(4) 设 $Ax=b$ 有解. 则 $Ax=b$ 与 $A^TAx = A^Tb$ 同解.

{% sol %}
正确! 若 $Ax=b$, 则 $A^TAx = A^Tb$. 若 $A^TAx = A^Tb$, 则 $A^T(Ax - b) = 0$. 依题设记 $b = Ax_0$, 则 $A^TA(x-x_0) = 0$. 因此 $(x-x_0)A^TA(x-x_0) = 0$, 从而 $A(x-x_0)$ 是零向量. 这说明 $Ax = b$. 可对照[此作业题](HW4-solu#配完全平方).
{% endsol %}

(5) 设 $AB$ 有意义. 则 $r(AB) = r(B)$ $\iff$ $A$ 列满秩.

{% sol %}
错误! 反例: $A = B = O$.
{% endsol %}

(6) 矩阵 $A$ 行满秩 $\iff$ 存在矩阵 $B$ 使得 $AB$ 可逆.

{% sol %}
正确! 行满秩矩阵的列阶梯形是 $AQ = (I \mid O)$. 注意到 $A(Q\binom IO) = I$ 可逆矩阵.
{% endsol %}

(7) 向量 $u,v,w$ 线性相关 $\iff$ $u+v,v+w,w+u$ 线性相关.

{% sol %}
正确! 注意到 $u = \frac{1}{2}((u+v)+(v+w)-(u+w))$. 依照对称性, 左侧向量可以被右侧向量线性表出. 两个向量组可以彼此线性表出, 从而两个向量组秩相同.
{% endsol %}

(8) 设 $A \in \mathbb R^{n \times n}$. 若 $AX=XA$, $\forall X \in \mathbb R^{n \times n}$, 则 $A$ 是纯量矩阵.

{% sol %}
正确! 记 $E_{i,j}$ 是仅在 $(i,j)$ 位置为 $1$ 的矩阵, 其余位置为 $0$ 的矩阵. 考虑 $AE_{i,j} = E_{i,j}A$, 则 $a_{i,i} = a_{j,j}$, 同时 $A$ 第 $i$ 列与第 $j$ 行的其余元素均为 $0$. 因此 $A$ 是纯量矩阵.

- 注: 纯量矩阵是指形如 $kI$ 的矩阵, 此处 $k \in \mathbb R$, $I$ 是单位矩阵.

{% endsol %}

(9) $Ax = b$ 有解 $\iff$ $A^Ty = 0$, $y^T b = 1$ 无解.

{% sol %}
所有回答均给分. 题目本意是指右侧方程组 $\left\{\begin{aligned}A^Ty & = 0, \\ y^Tb & = 1.\end{aligned}\right.$ 无解, 并非方程 $A^T y = 0$ 与 $y^Tb = 1$ 均无解.
\\
我们证明原命题. 即证 $Ax = b$ 无解当且仅当 $y^T (A \mid b) = (0^T \mid 1)$ 有解. 记 $ref(A \mid b) = (ref(A) \mid b')$, 则

- $y^T (A \mid b) = (0^T \mid 1)$ 有解, 当且仅当
- $z^T (ref(A) \mid b') = (0^T \mid 1)$ 有解, 当且仅当
- $b'$ 在 $ref(A)$ 的零行所在行有非零取值, 当且仅当
- $r((A \mid b)) > r(A)$, 当且仅当
- $Ax = b$ 无解.

{% endsol %}

(10) 任何方阵都是两个可逆矩阵的和.

{% sol %}
正确! 取 $x \in \mathbb R$, 作分解 $A =  (A+xI) - xI$. 当 $x$ 足够大时, $(A+xI)$ 可逆. 可对照[此作业题](HW7-solu#行满秩矩阵的一个例子).
{% endsol %}

### T2 计算基本空间

设 $A = \begin{pmatrix}3&-2&2&-3\\2&-1&1&-2\\2&-2&2&-2\\-1&1&-1&1\end{pmatrix}$.

(1) 试求可逆矩阵 $P$ 使得 $PA$ 是简化行阶梯形.

{% sol %}
通过行初等变换, 作 $(A \mid I) \to (ref(A)\mid P)$:

$$\begin{equation}
 \begin{array}{l}
\begin{pmatrix}
3 & -2 & 2 & -3 & \mid  & 1 & 0 & 0 & 0\\
2 & -1 & 1 & -2 & \mid  & 0 & 1 & 0 & 0\\
2 & -2 & 2 & -2 & \mid  & 0 & 0 & 1 & 0\\
-1 & 1 & -1 & 1 & \mid  & 0 & 0 & 0 & 1
\end{pmatrix}\\
\\
\begin{pmatrix}
0 & 1 & -1 & 0 & \mid  & 1 & 0 & 0 & 3\\
0 & 1 & -1 & 0 & \mid  & 0 & 1 & 0 & 2\\
0 & 0 & 0 & 0 & \mid  & 0 & 0 & 1 & 2\\
-1 & 1 & -1 & 1 & \mid  & 0 & 0 & 0 & 1
\end{pmatrix}\\
\\
\begin{pmatrix}
0 & 1 & -1 & 0 & \mid  & 1 & 0 & 0 & 3\\
0 & 0 & 0 & 0 & \mid  & -1 & 1 & 0 & -1\\
0 & 0 & 0 & 0 & \mid  & 0 & 0 & 1 & 2\\
-1 & 0 & 0 & 1 & \mid  & -1 & 0 & 0 & -2
\end{pmatrix}\\
\\
\begin{pmatrix}
1 & 0 & 0 & -1 & \mid  & 1 & 0 & 0 & 2\\
0 & 1 & -1 & 0 & \mid  & 1 & 0 & 0 & 3\\
0 & 0 & 0 & 0 & \mid  & -1 & 1 & 0 & -1\\
0 & 0 & 0 & 0 & \mid  & 0 & 0 & 1 & 2
\end{pmatrix}
\end{array}
\end{equation}$$

此题答案不唯一, 因为 $P$ 的后两行可以随意线性组合 (同时保持满秩) 并加至前两行.

{% endsol %}

(2) 设 $b = Ae_1 + 2Ae_2$, 求 $Ax=b$ 的所有解.

{% sol %}
我们知道解等于特殊解加上零解. 依照 $ref$, $Ax = 0$ 的解形如列向量 $(a,b,b,a)$. 从而方程的解是 $(1+a,2+b,b,a)$, 其中 $a,b$ 是任意实数.
{% endsol %}

(3) 求矩阵 $L_{4 \times 2}$, $U_{2 \times 4}$ 使得 $A = LU$; 由此计算 $A^n$.

{% sol %}

试观察行初等变换 $(A \mid I ) \to (ref(A) \mid P)$. 由于 $ref(A)$ 的前两列是 $\begin{pmatrix}1 & 0\\0 & 1\\0 & 0\\0 & 0\end{pmatrix}$, 从而 $P^{-1}$ 的前两列就是 $A$ 的前两列. 此时得到分解

$$\begin{equation}
A=\begin{pmatrix}
3 & -2\\
2 & -1\\
2 & -2\\
-1 & 1
\end{pmatrix}\begin{pmatrix}
1 & 0 & 0 & -1\\
0 & 1 & -1 & 0
\end{pmatrix} = : LU.
\end{equation}$$

$A^n = L(UL)^{n-1} U = L\begin{pmatrix}4&-3\\0&1\end{pmatrix}^{n-1} U$. 由初中方法知 $(UL)^k = \begin{pmatrix}4^k&1-4^k\\0&1\end{pmatrix}$. 写至此步即可.

- 注: $UL$ 不唯一. 实际上, 这在相差一个相似矩阵的意义下唯一. $UL$ 的特征根应当是 $4$ 和 $-1$.

{% endsol %}

(4) 求 $A$ 的四个子空间的各一组基并验证 Strang 的线性代数基本定理.

{% sol %}
注意到可逆行变换不改变行空间和零空间, 可逆列变换不改变列空间和左零空间. 因此, $A$ 与 $U$ 有相同的行空间和零空间, 与 $L$ 有相同的列空间和左零空间. 容易看出 (零空间随便猜即可)

1. 行空间的基: $U$ 的两行. 注意到 $U$ 与 $A$ 通过行变换彼此得到, 从而行空间相同.
2. 列空间的基: $L$ 的两列. 注意到 $L$ 与 $A$ 通过列变换彼此得到, 从而列空间相同.
3. 零空间的基: $\{(1,0,0,1), (0,1,1,0)\}$ (列向量). 注意到 $Ax=0$ 等价于 $Ux=0$.
4. 左零空间的基: $\{(0,0,1,2), (1,-1,0,1)\}$ (行向量). 注意到 $y^TA=0$ 等价于 $y^TL=0$. 如果觉得左零空间难以看出, 则可以通过初等列变换将 $L$ 化作 $\begin{pmatrix}1&0\\1&1\\0&-2\\0&1\end{pmatrix}$

直接地,

- $\dim C(A) + \dim N(A) = 4$ (列秩 + 零空间维数 = 列数),
- $\dim C(A^T) + \dim N(A^T) = 4$ (行秩 + 左零空间维数 = 行数),
- $\dim C(A) = \dim C(A^T) = 2$ (秩).

{% endsol %}

### T3 构造幂等与幂零方阵

(1) 构造三阶非对角矩阵 $A$ 与 $B$ 使得 $A^3 = I$, $A^2 \neq I$, $B^3 = O$, $B^2 \neq O$.

{% sol %}
取$$\begin{equation}
A=\begin{pmatrix}0 & 1 & 0\\0 & 0 & 1\\1 & 0 & 0\end{pmatrix}, B=\begin{pmatrix}0 & 1 & 0\\0 & 0 & 1\\0 & 0 & 0\end{pmatrix}.
\end{equation}$$
{% endsol %}

(2) 构造 $n \geq 4$ 阶非对角矩阵 $A,B$ 使得 $A^n = I$, $A^{n-1} \neq I$, $B^n = O$, $B^{n-1} \neq O$.

{% sol %}
同上. $B$ 是次对角线全 $1$, 其余位置为 $0$ 的矩阵. $A$ 即 $B$ 加上左下角的 $1$. 构造不唯一.
{% endsol %}

(3) 设 $B$ 是 (2) 中的矩阵, 证明 $I+B$ 可逆并求其逆.

{% sol %}
由数学分析, $(1+x)^{-1} = 1-x+x^2-x^3+\cdots$. 依照余项,

$$\begin{equation}
(I+B)(I+(-B)+(-B)^2 - \cdots + (-B)^{n-1}) = I + (-B)^n\cdot( \cdots).
\end{equation}$$

{% endsol %}

(4) 设 $A,B$ 是 (2) 中的矩阵, 判断 $A+B$ 是否可逆并说明理由.

{% sol %}
这是开放问题. 我们修改 (2) 中构造使得本题易于回答: $A$ 不变, $B$ 加上负号. 那么 $A+B$ 是左下角为 $1$ 剩余位置为 $0$ 的矩阵, 因此不可逆.
{% endsol %}

### T4 送分题

设 $v_1,v_2,\ldots ,v_s \in \mathbb R^n$. 证明或否定: $v_1,v_2,\ldots,v_n$ 线性无关当且仅当 $v_1-v_2$, $v_2-v_3$, $v_3-v_4$, $\ldots$, $v_{s}-v_1$ 线性无关.

{% sol %}
错误. 右侧总是线性相关的, 因为全加起来是 $0$.
{% endsol %}

### T5 直接验证题

设所有矩阵均可逆, 证明华罗庚恒等式 (1949年):

$$\begin{equation}
A - (A^{-1} + (B^{-1} - A)^{-1})^{-1} = ABA.
\end{equation}$$

{% sol %}
即证 $(A-ABA)$ 与 $(A^{-1} + (B^{-1} - A)^{-1})$ 互逆:

$$\begin{aligned}
& (A-ABA)(A^{-1} + (B^{-1} - A)^{-1}) \\
=\ &I-AB+AB(B^{-1}-A)(B^{-1} - A)^{-1}  = I.
\end{aligned}$$

对方阵而言, 左逆等于右逆 (见[作业](HW7-solu#初等变换的使用)), 证毕.

{% endsol %}

### T6 略

## 评分

### 评分标准

**T1** 每小题 2 分, 共 20 分.

**T2** (1) 5 分; (2) 5 分; (3) 5 分; (4) 5 分; 共 20 分. 每小题酌情给分.

**T3** (1) 5 分; (2) 5 分; (3) 5 分; (4) 5 分; 共 20 分. 每小题酌情给分.

**T4** 指出右侧向量线性相关 (举例或证明一般情况均可) 得 20 分. 不满足上述情形的非白卷得 10 分. 白卷得 0 分.

**T5** 过程完整得 10 分, 缺少细节得 8 分, 不满足上述任意情形的非白卷得 5 分, 白卷得 0 分.

**T6** 视情况而定, 得 10 分或 8 分, 白卷得 0 分.

### 得分情况

各题平均分如下:

- T1: 14.44
- T2: 11.08
- T3: 11.35
- T4: 15.80
- T5: 7.10
- T6: 9.08
- 总分: 68.84

学得比较好的: 史晨洋, 张家杰, 陆航宇, 唐木白, 吕昊天, 张振宇, 邢子健, 孙睿勃, 曾楚笑, 滕伟, 郭子谦, 李思澄, 张清扬, 姜力豪, 解一力, 赵梓程, 周珂宇, 陈昕睿, 吕云汉, 魏靖芸, 尹烁宇, 汪子栋, 薛乐延.
