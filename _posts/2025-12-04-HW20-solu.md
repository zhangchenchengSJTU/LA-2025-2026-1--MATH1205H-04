---
title: HW20-solu
author: Chencheng Zhang
layout: post
category: solution
---

## 计算题训练

### 计算 Jordan 标准型与过渡矩阵

{% ex %}
计算以下矩阵的 Jordan 标准型以及过渡矩阵：

$$\begin{equation}
A = \begin{pmatrix}
 -6& 2& 4 &-10& 5\\
-14& 5& 8 &-19& 9\\
  3&-1&-1& 5&-3\\
  8&-2&-4&12&-5\\
  8&-2&-4&10&-3
\end{pmatrix}.
\end{equation}$$

{% pf %}
**Step 1 (计算特征根)** 计算特征多项式. 我们对 $(xI - A)$ 进行任意可逆行列初等变换, 最后结果差一个数乘, 但这不重要. 

$$\begin{equation}
xI - A = \begin{pmatrix}
 x+6& -2& -4 &10& -5\\
14& x-5& -8 &19& -9\\
 -3&1&x+1&-5&3\\
    -8&2&4&x-12&5\\
    -8&2&4&-10&x+3
\end{pmatrix},
\end{equation}$$

该矩阵左下角是非常规律的, 不妨使用 $\binom 22$ 所在的一列进行列消元, 得

$$\begin{equation}
\begin{pmatrix}
x-2 & -2 & 0   & 10  & -5\\
4x-6& x-5& 2-2x& 19  & -9\\
 1  & 1  & x-1 & -5  &3\\
 0  & 2  & 0   &x-12 &5\\
 0  & 2  & 0   &-10  &x+3
\end{pmatrix}.
\end{equation}$$

再依次把 $-c_1$ 加到 $c_2$, 把 $-r_4$ 加到 $r_5$, 把 $c_5$ 加到 $c_4$, 得

$$\begin{equation}
\begin{pmatrix}
x-2 & -x & 0   & 5  & -5\\
4x-6& 1-3x& 2-2x& 10  & -9\\
 1  & 0  & x-1 & -2  &3\\
 0  & 2  & 0   &x-7 &5\\
 0  & 0  & 0   &0  &x-2
\end{pmatrix}.
\end{equation}$$

提出因子 $(x-2)$, 得左上方 $4\times 4$ 矩阵:

$$\begin{equation}
\begin{pmatrix}
x-2 & -x & 0   & 5 \\
4x-6& 1-3x& 2-2x& 10 \\
 1  & 0  & x-1 & -2 \\
 0  & 2  & 0   &x-7
\end{pmatrix}.
\end{equation}$$

注意到第三列两项差一个数乘. 将 $2r_3$ 加至 $r_2$, 得

$$\begin{equation}
\begin{pmatrix}
x-2 & -x & 0   & 5 \\
4x-4& 1-3x& 0& 6 \\
 1  & 0  & x-1 & -2 \\
 0  & 2  & 0   &x-7
\end{pmatrix}.
\end{equation}$$

提出因子 $(x-1)$, 得剩下的 $3\times 3$ 阶子式:

$$\begin{equation}
\begin{pmatrix}
x-2 & -x &  5 \\
4x-4& 1-3x& 6 \\
 0  & 2  &x-7
\end{pmatrix}.
\end{equation}$$

对最后一行展开, 目测得到 (可能差一个负号)

$$\begin{equation}
2(6(x-2)-5(4x-4))-(x-7)((x-2)(1-3x)+x(4x-4)) = -(x-1)^2(x-2).
\end{equation}$$

综上, 特征多项式为 $(x-1)^3(x-2)^2$. 我们知道根空间分解 $\mathbb  R^5 = V_1 \oplus V_2$. 由特征多项式知, 其维数分别是 $3$ 与 $2$.
\\
**Step 2 (计算 $J_?(1)$)** 我们先找 $N(A-I)$ 的基, $A-I$ 即

$$\begin{equation}
\begin{pmatrix}
 -7& 2& 4 &-10& 5\\
-14& 4& 8 &-19& 9\\
  3&-1&-2& 5&-3\\
  8&-2&-4&11&-5\\
  8&-2&-4&10&-4
\end{pmatrix}.
\end{equation}$$

可逆行变换不改变零空间. 中间两列明显成比例, 我们用 $r_3$ 消去上下两行的第二与第三列, 得

$$\begin{equation}
\begin{pmatrix}
 -1& 0& 0 &0& -1\\
 -2& 0& 0 &1&-3\\
  3&-1&-2& 5&-3\\
  2& 0& 0& 1& 1\\
  2& 0& 0& 0&2
\end{pmatrix}.
\end{equation}$$

依照 $ref$ 算法, 我们发现前两列线性无关, $c_3 = 2c_2$, $\{c_1,c_2,c_4\}$ 线性无关 (比较 $0$ 的位置), $c_5 = c_1-c_4+c_2$, 从而 $ref$ 是

$$\begin{equation}
\begin{pmatrix}
 1& 0& 0& 0& 1\\
 0& 1& 2& 0& 1\\
 0& 0& 0& 1& -1\\
 0& 0& 0& 0& 0\\
 0& 0& 0& 0& 0
\end{pmatrix}.
\end{equation}$$

我们发现 $N(I-A)$ 比 $V_1$ 少一维, 从而 Jordan 块是 $J_2(1)$ 和 $J_1(1)$. 由幂零标准型算法, $C(I-A) \cap N(I - A)$ 是一维空间, 即 $N(I - A)$ 中形如 $(I-A)x$ 的向量构成一维空间. 注意到 $A-I$ 的第二列 (记作 $u$) 即为所求. 由 $u$ 的选取, 方程 $(A-I)x = u$ 的一个解是 $(0,1,0,0,0)$, 记作 $v_1$. 记 $(A-I)v_1 = v_2$, 再取 $v_3$ 使得 $\{v_2,v_3\}$ 是 $N(I-A)$ 的一组基, 比如 $v_3 = (0,2,-1,0,0)$. 此时

$$\begin{equation}
(A-I)(v_2 \mid v_1 \mid v_3) = (0 \mid v_2 \mid 0).
\end{equation}$$

这说明

$$\begin{equation}
A \cdot (v_2 \mid v_1 \mid v_3 \mid ? \mid ?) = (v_2 \mid v_1 \mid v_3 \mid ? \mid ?)\cdot \begin{pmatrix}
    1&1\\&1\\ &&1 \\ &&&2 & ?\\ &&&&2
\end{pmatrix}.
\end{equation}$$

**Step 3 (计算 $J_?(2)$)** 类似地, 我们计算 $N(A-2I)$ 的基, $A-2I$ 即

$$\begin{equation}
\begin{pmatrix}
 -8& 2& 4 &-10& 5\\
-14& 3& 8 &-19& 9\\
  3&-1&-3& 5&-3\\
  8&-2&-4&10&-5\\
  8&-2&-4&10&-5
\end{pmatrix}.
\end{equation}$$

显然 $r_4$ 与 $r_5$ 是 $r_1$ 的数乘倍, 因此矩阵的零空间由前三列所在的子矩阵决定. 我们求以下矩阵的零空间:

$$\begin{equation}
\begin{pmatrix}
 -8& 2& 4 &-10& 5\\
-14& 3& 8 &-19& 9\\
  3&-1&-3& 5&-3
\end{pmatrix}.
\end{equation}$$

阶梯形

$$\begin{equation}
\begin{pmatrix}
1&&&1&-1/8\\
&1&&1&3/4\\
&&1&-1&5/8\\
\end{pmatrix}
\end{equation}$$

记 $v_4$ 与 $v_5$ 为 $\binom {F}{-I}$ 的两列. $N(A-2I)$ 与 $V_2$ 同是二维空间, 因此 Jordan 块为两个 $J_1(2)$.

**Step 4** 综上, 

$$\begin{equation}
(v_2\mid v_1\mid v_3\mid v_4\mid v_5)\cdot \begin{pmatrix}
    1&1&&&\\
    &1&&&\\
    &&1&&\\
    &&&2&\\
    &&&&2
\end{pmatrix} = A \cdot (v_2\mid v_1\mid v_3\mid v_4\mid v_5).
\end{equation}$$

{% endpf %}

{% endex %}

{% pro %}

算 $P$ 和 $J$:

$$\begin{equation}
A_1 = \begin{pmatrix}
2 & -2 & 1 & -2 & -1 \\
0 & 1 & 0 & -2 & 0 \\
1 & -2 & 2 & -2 & -1 \\
0 & 0 & 0 & 3 & 0 \\
2 & -4 & 2 & -8 & -1
\end{pmatrix},\quad A_2 = \begin{pmatrix}
    2 & 0 & -1 & 2 & 0 \\
    0 & 2 & 0 & 1 & 0 \\
    1 & -2 & 2 & -3 & -1 \\
    0 & 0 & 0 & 2 & 0 \\
    2 & -5 & 2 & -10 & -1
\end{pmatrix}.
\end{equation}$$

{% pf %}

在 [Wolfram](https://www.wolframalpha.com/) 搜索 `Jordan form { {2, -2, 1, -2, -1},  {0,  1, 0, -2,  0},  {1, -2, 2, -2, -1},  {0,  0, 0,  3,  0},  {2, -4, 2, -8, -1}}`. 细节略.

{% endpf %}

{% endpro %}

### 计算奇异值分解

奇异值分解的原理见 [HW19](HW19#奇异值分解).

{% ex %}
计算以下矩阵的奇异值分解:

$$\begin{equation}
A = \begin{pmatrix}
 3 & 2 & 2 \\
 2 & 3 & -2
\end{pmatrix}.
\end{equation}$$

{% pf %}
计算奇异值分解可以从 $AA^T$ 或 $A^TA$ 入手. 这里我们计算 $AA^T$, 因为阶数更小:

$$\begin{equation}
AA^T = \begin{pmatrix}
17 & 8 \\
8 & 17
\end{pmatrix}.
\end{equation}$$

矩阵的特征值 $25$ 和 $9$. 取正交对角分解

$$\begin{equation}
AA^T = U D U^T = \frac{1}{\sqrt 2}\begin{pmatrix}
    1 & 1 \\
    1 & -1
\end{pmatrix}
\begin{pmatrix}
    25 & 0 \\
    0 & 9
\end{pmatrix}
\left(\frac{1}{\sqrt 2}\begin{pmatrix}
    1 & 1 \\
    1 & -1
\end{pmatrix}\right)^{-1}.
\end{equation}$$

奇异值分解 $A = U\Sigma V^T$ 中的矩阵

$$\begin{equation}
U = \frac{1}{\sqrt 2}\begin{pmatrix}
    1 & 1 \\
    1 & -1
\end{pmatrix},\quad \Sigma = \begin{pmatrix}
    5 & 0 & 0 \\
    0 & 3 & 0
\end{pmatrix}.
\end{equation}$$

考虑矩阵 $M = \sqrt 2 U A$. 此处 $M$ 的相异行向量必垂直, 因为 $MM^T$ 是对角矩阵. 我们将

$$\begin{equation}
M = \begin{pmatrix}
    5 & 5 & 0 \\
    1 & -1 & 4
\end{pmatrix}.
\end{equation}$$

扩充成 $3 \times 3$ 行正交矩阵, 并放缩其行向量使之模长为 $1$, 得

$$\begin{equation}
M = (I \mid 0) \cdot \begin{pmatrix}
    5 & 5 & 0 \\
    1 & -1 & 4 \\
    2 & -2 & -1
\end{pmatrix} = \sqrt 2 \cdot \begin{pmatrix}
    5&0&0\\0&3&0
\end{pmatrix} \cdot \begin{pmatrix}
    \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} & 0 \\
    \frac{1}{3\sqrt{2}} & -\frac{1}{3\sqrt{2}} & \frac{4}{3\sqrt{2}} \\
    \frac{2}{3} & -\frac{2}{3} & -\frac{1}{3}
\end{pmatrix}.
\end{equation}$$

综上,

$$\begin{equation}
A = U \Sigma V^T = \begin{pmatrix}
    \frac{1}{\sqrt 2} & \frac{1}{\sqrt 2} \\
    \frac{1}{\sqrt 2} & -\frac{1}{\sqrt 2}
\end{pmatrix}\begin{pmatrix}
    5 & 0 & 0 \\
    0 & 3 & 0
\end{pmatrix}\begin{pmatrix}
    \frac{1}{\sqrt{2}} & \frac{1}{3\sqrt{2}} & \frac{2}{3} \\
    \frac{1}{\sqrt{2}} & -\frac{1}{3\sqrt{2}} & -\frac{2}{3} \\
    0 & \frac{4}{3\sqrt{2}} & -\frac{1}{3}
\end{pmatrix}^T.
\end{equation}$$

{% endpf %}

{% endex %}

{% pro %}
计算奇异值分解:

$$\begin{equation}
A_1 = \begin{pmatrix}
1 & 0 & 2\\
0 & 1 & 2
\end{pmatrix},\quad A_2 = \begin{pmatrix}
    3 & 4 & 1\\
    1 & -4 & 3
\end{pmatrix}.
\end{equation}$$

{% sol %}
在 [Wolfram](https://www.wolframalpha.com/) 搜索 `singular value decomposition { {3,4,1},{1,-4,3}}`. 细节略.
{% endsol %}

{% endpro %}

### Kronecker 积

Kronecker 积用于解释矩阵方程 $AX - XB +CXD = F$.

{% def %}
(Kronercker 积).给定矩阵 $A \in \mathbb F^{p \times q}$ 与 $B \in \mathbb F^{m \times n}$, 则它们的 Kronecker 积定义为分块矩阵
$$\begin{equation}
A \otimes B = \begin{pmatrix}
a_{11}B & a_{12}B & \cdots & a_{1q}B \\
a_{21}B & a_{22}B & \cdots & a_{2q}B \\
\vdots  & \vdots  & \ddots & \vdots  \\
a_{p1}B & a_{p2}B & \cdots & a_{pq}B
\end{pmatrix} \in \mathbb F^{pm \times qn}.
\end{equation}$$

{% enddef %}

矩阵 $A \otimes B$ 中的分量可以用四元数组 $((i,j);(k,l))$ 标记, 表示 $((i-1)p+k, (j-1)q+l)$ 位置的元素, 即 $a_{ij} b_{kl}$.

{% lem %}
容易检验

1. $\otimes$ 是双线性映射. 换言之, $(A+\lambda A')\otimes B = A\otimes B + \lambda A' \otimes B$, $A \otimes (B + \lambda B') = A \otimes B + \lambda A \otimes B'$.
2. $(A\otimes B) \otimes C = A \otimes (B \otimes C)$.
3. $(A \otimes B)(C \otimes D) = (AC) \otimes (BD)$, 其中矩阵乘法均有定义.
4. $(A \otimes B)^T = A^T \otimes B^T$.
5. 如果 $A$ 与 $B$ 可逆, 则 $A \otimes B$ 也可逆, 且 $(A \otimes B)^{-1} = A^{-1} \otimes B^{-1}$.
6. ...

{% pf %}
(1). 下比较 $(A+\lambda A')\otimes B$ 与 $A\otimes B + \lambda A' \otimes B$ 在 $((i,j);(k,l))$ 位置的分量, 它们均为 $(a_{ij} + \lambda a'_{ij})b_{kl}$.
\\
(2). 写成大矩阵即可直接看出.
\\
(3). 下比较 $(A\otimes B)(C \otimes D)$ 与 $(AC) \otimes (BD)$ 在 $((i,j),(k,l))$ 位置的分量.
$$\begin{equation}
((A\otimes B)(C \otimes D))_{((i,j);(k,l))} = \sum_{r=1}^q \sum_{s=1}^n (a_{ir} b_{ks})(c_{rj} d_{sl}) = \left(\sum_{r=1}^q a_{ir} c_{rj}\right) \left(\sum_{s=1}^n b_{ks} d_{sl}\right) = ((AC) \otimes (BD))_{((i,j);(k,l))}.
\end{equation}$$
(4). 直接地, $A^T \otimes B^T$ 在 $((i,j);(k,l))$ 位置的分量是 $a_{ji} b_{lk}$, 而 $(A \otimes B)^T$ 在 $((i,j);(k,l))$ 位置的分量是 $(A \otimes B)_{((j,i);(l,k))} = a_{ji} b_{lk}$.
\\
(5). 由 (3) 可知 $(A \otimes B)(A^{-1} \otimes B^{-1}) = (AA^{-1}) \otimes (BB^{-1}) = I \otimes I = I$.

{% endpf %}

{% endlem %}

{% ex %}
若 $A,B \in \mathbb R^{n \times n}$ 是正定矩阵, 则

$$\begin{equation}
(a_{i,j}\cdot b_{i,j})_{n\times n} \in \mathbb R^{n \times n}
\end{equation}$$

也是正定矩阵.

{% pf %}
$A$ 正定, 则存在可逆矩阵 $P$ 使得 $A = P^TP$. 同理, 存在可逆矩阵 $Q$ 使得 $B = Q^TQ$. 因此

$$\begin{equation}
A\otimes B = (P^TP) \otimes (Q^TQ) = (P \otimes Q)^T (P \otimes Q)
\end{equation}$$

也是正定矩阵. 注意到 $(a_{i,j}\cdot b_{i,j})_{n\times n}$ 是 $A \otimes B$ 的主子式, 从而也正定.

{% endpf %}

{% endex %}

{% cor %}
若 $A$ 与 $B$ 满足性质 $\mathfrak P$, 则 $A \otimes B$ 也满足性质 $\mathfrak P$. 此处的 $\mathfrak P$ 可以是可逆性, 对称性, 正定性, 半正定性, 正交性, 幂零性, 可对角化性, 可上三角化性.
{% endcor %}

{% cor %}
有些矩阵具看上去有成比例的分块, 即能写成 $A \otimes B$ 的形式. 对这类矩阵求逆, 幂, Schur 上三角化, 正交相似对角化, 奇异值分解, LU 分解等时, 都可以化简为对 $A$ 与 $B$ 分别进行相应的运算, 然后再取 Kronecker 积.
{% endcor %}

{% pro %}
记 $vec(M)$ 是矩阵拉直成列向量的操作. 若 $M \in \mathbb F^{m \times n}$, 则

$$\begin{equation}
vec(v_1 \mid v_2 \mid \cdots \mid v_n) = \begin{pmatrix}
v_1\\ v_2\\ \vdots \\ v_n
\end{pmatrix} \in \mathbb F^{mn \times 1}.
\end{equation}$$

试验证 (验证容易):

1. 矩阵方程 $A X = B$ 可写成 $(I_n \otimes A) \cdot vec(X) = vec(B)$,
2. 矩阵方程 $X D = C$ 可写成 $(D^T \otimes I_m) \cdot vec(X) = vec(C)$,
3. 矩阵方程 $P X Q = Y$ 可写成 $(Q^T \otimes P) \cdot vec(X) = vec(Y)$.

{% endpro %}
